From 07a68ca74f94d100d02729979e882a5c87dff747 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?R=C3=A9mi=20Bernon?= <rbernon@codeweavers.com>
Date: Wed, 22 Dec 2021 20:18:21 +0100
Subject: [PATCH 4/9] dinput: Return HID class guid in DIPROP_GUIDANDPATH
 property.

---
 dlls/dinput/joystick_hid.c | 1 +
 dlls/dinput8/tests/hid.c   | 1 -
 2 files changed, 1 insertion(+), 1 deletion(-)

diff --git a/dlls/dinput/joystick_hid.c b/dlls/dinput/joystick_hid.c
index db543921bf2..b4ab4b9400f 100644
--- a/dlls/dinput/joystick_hid.c
+++ b/dlls/dinput/joystick_hid.c
@@ -819,6 +819,7 @@ static HRESULT hid_joystick_get_property( IDirectInputDevice8W *iface, DWORD pro
     case (DWORD_PTR)DIPROP_GUIDANDPATH:
     {
         DIPROPGUIDANDPATH *value = (DIPROPGUIDANDPATH *)header;
+        value->guidClass = GUID_DEVCLASS_HIDCLASS;
         lstrcpynW( value->wszPath, impl->device_path, MAX_PATH );
         return DI_OK;
     }
diff --git a/dlls/dinput8/tests/hid.c b/dlls/dinput8/tests/hid.c
index de661b63f56..d1b34acfdb1 100644
--- a/dlls/dinput8/tests/hid.c
+++ b/dlls/dinput8/tests/hid.c
@@ -4156,7 +4156,6 @@ static void test_simple_joystick( DWORD version )
 
     hr = IDirectInputDevice8_GetProperty( device, DIPROP_GUIDANDPATH, &prop_guid_path.diph );
     ok( hr == DI_OK, "GetProperty DIPROP_GUIDANDPATH returned %#x\n", hr );
-    todo_wine
     ok( IsEqualGUID( &prop_guid_path.guidClass, &GUID_DEVCLASS_HIDCLASS ), "got guid %s\n",
         debugstr_guid( &prop_guid_path.guidClass ) );
     todo_wine
-- 
2.34.1

