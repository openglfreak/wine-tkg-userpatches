From: Mohamad Al-Jaf <mohamadaljaf@gmail.com>
Subject: [PATCH v6 3/4] wdscore: Add stubs for ConstructPartialMsgV[AW].
Message-Id: <20220131091619.350491-3-mohamadaljaf@gmail.com>
Date: Mon, 31 Jan 2022 04:16:18 -0500
In-Reply-To: <20220131091619.350491-1-mohamadaljaf@gmail.com>
References: <20220131091619.350491-1-mohamadaljaf@gmail.com>

Enables the Windows MediaCreationTool21H2 to run.

Signed-off-by: Mohamad Al-Jaf <mohamadaljaf@gmail.com>
---
v6: - Rebase.
---
 dlls/wdscore/main.c             | 20 ++++++++++++++++++++
 dlls/wdscore/wdscore.spec       |  4 ++--
 dlls/wdscore/wdscore_internal.h | 11 +++++++++++
 3 files changed, 33 insertions(+), 2 deletions(-)

diff --git a/dlls/wdscore/main.c b/dlls/wdscore/main.c
index 11111111111..11111111111 100644
--- a/dlls/wdscore/main.c
+++ b/dlls/wdscore/main.c
@@ -54,3 +54,23 @@ void *CurrentIP(void)
     return 0;
 }
 #endif
+
+
+/***********************************************************************
+ *           ConstructPartialMsgVA (wdscore.@)
+ */
+LPVOID WINAPI ConstructPartialMsgVA( WdsLogLevel level, LPCSTR msg, va_list args )
+{
+    FIXME( "%u %s - stub\n", level, debugstr_a(msg) );
+    return NULL;
+}
+
+
+/***********************************************************************
+ *           ConstructPartialMsgVW (wdscore.@)
+ */
+LPVOID WINAPI ConstructPartialMsgVW( WdsLogLevel level, LPCWSTR msg, va_list args )
+{
+    FIXME( "%u %s - stub\n", level, debugstr_w(msg) );
+    return NULL;
+}
diff --git a/dlls/wdscore/wdscore.spec b/dlls/wdscore/wdscore.spec
index 11111111111..11111111111 100644
--- a/dlls/wdscore/wdscore.spec
+++ b/dlls/wdscore/wdscore.spec
@@ -69,8 +69,8 @@
 #@ extern g_bEnableDiagnosticMode
 @ stub ConstructPartialMsgIfA
 @ stub ConstructPartialMsgIfW
-@ stub ConstructPartialMsgVA
-@ stub ConstructPartialMsgVW
+@ stdcall ConstructPartialMsgVA(long str ptr)
+@ stdcall ConstructPartialMsgVW(long wstr ptr)
 @ cdecl CurrentIP()
 @ stub EndMajorTask
 @ stub EndMinorTask
diff --git a/dlls/wdscore/wdscore_internal.h b/dlls/wdscore/wdscore_internal.h
index 11111111111..11111111111 100644
--- a/dlls/wdscore/wdscore_internal.h
+++ b/dlls/wdscore/wdscore_internal.h
@@ -19,6 +19,17 @@
 #ifndef __WDSCORE_INTERNAL_H
 #define __WDSCORE_INTERNAL_H
 
+typedef enum _WdsLogLevel {
+    WdsLogLevelAssert     = 0x0000000,
+    WdsLogLevelFatalError = 0x1000000,
+    WdsLogLevelError      = 0x2000000,
+    WdsLogLevelWarning    = 0x3000000,
+    WdsLogLevelInfo       = 0x4000000,
+    WdsLogLevelStatus     = 0x5000000,
+    WdsLogLevelVerbose    = 0x6800000,
+    WdsLogLevelTrace      = 0x7000000
+} WdsLogLevel;
+
 void *CurrentIP(void);
 
 #endif /* __WDSCORE_INTERNAL_H */

-- 
2.35.1

