From 68c694d130aa6eda7138b3be03956395872eb8d9 Mon Sep 17 00:00:00 2001
From: Torge Matthies <openglfreak@googlemail.com>
Date: Sat, 6 Mar 2021 01:26:06 +0100
Subject: [PATCH 9/9] winepulse.drv: Make duration and period from
 AudioClient_Initialize configurable per environment variables.

Signed-off-by: Torge Matthies <openglfreak@googlemail.com>
---
 dlls/winepulse.drv/mmdevdrv.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/dlls/winepulse.drv/mmdevdrv.c b/dlls/winepulse.drv/mmdevdrv.c
index 68a35007756..f83113a800f 100644
--- a/dlls/winepulse.drv/mmdevdrv.c
+++ b/dlls/winepulse.drv/mmdevdrv.c
@@ -2251,6 +2251,9 @@ static HRESULT WINAPI AudioClient_Initialize(IAudioClient3 *iface,
         RegCloseKey(key);
     }
 
+    parse_envar_reftime_with_status("STAGING_AUDIO_DURATION", &duration, "Audio duration set to %ld.\n");
+    parse_envar_reftime_with_status("STAGING_AUDIO_PERIOD", &period, "Audio period set to %ld.\n");
+
     This->period_bytes = pa_frame_size(&This->ss) * MulDiv(period, This->ss.rate, 10000000);
 
     This->bufsize_frames = ceil((duration / 10000000.) * fmt->nSamplesPerSec);
-- 
2.30.1

