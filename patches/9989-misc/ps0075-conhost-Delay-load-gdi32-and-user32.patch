From: Zebediah Figura <z.figura12@gmail.com>
Subject: [PATCH] conhost: Delay-load gdi32 and user32.
Message-Id: <20210212232334.32420-1-z.figura12@gmail.com>
Date: Fri, 12 Feb 2021 17:23:34 -0600

Both do some nontrivial work on DLL initialization, and conhost may quite
likely never need to display UI.

Signed-off-by: Zebediah Figura <z.figura12@gmail.com>
---
Actually gdi32 initialization is quite cheap now, at least on my machine,
though user32 still takes over 100 ms. In truth the annoyance for me was not
so much startup time as pollution of +server logs.

 programs/conhost/Makefile.in | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/programs/conhost/Makefile.in b/programs/conhost/Makefile.in
index 2a407006697..c371421da7d 100644
--- a/programs/conhost/Makefile.in
+++ b/programs/conhost/Makefile.in
@@ -1,6 +1,6 @@
 MODULE    = conhost.exe
-IMPORTS   = user32 gdi32 advapi32
-DELAYIMPORTS = comctl32
+IMPORTS   = advapi32
+DELAYIMPORTS = comctl32 gdi32 user32
 
 EXTRADLLFLAGS = -mwindows -municode
 

-- 
2.35.1

