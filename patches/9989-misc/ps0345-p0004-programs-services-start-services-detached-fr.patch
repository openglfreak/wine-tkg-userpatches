From: Eric Pouech <eric.pouech@gmail.com>
Subject: [PATCH v4 4/5] programs/services: start services detached from console
Message-Id: <164542886983.109938.11334419158360650188.stgit@euterpe>
Date: Mon, 21 Feb 2022 08:34:29 +0100
In-Reply-To: <164542808466.109938.2111311894986600388.stgit@euterpe>
References: <164542808466.109938.2111311894986600388.stgit@euterpe>

Signed-off-by: Eric Pouech <eric.pouech@gmail.com>

---
 programs/services/services.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/programs/services/services.c b/programs/services/services.c
index 11111111111..11111111111 100644
--- a/programs/services/services.c
+++ b/programs/services/services.c
@@ -1119,7 +1119,7 @@ found:
     process->use_count++;
     service_unlock(service_entry);
 
-    r = CreateProcessW(NULL, path, NULL, NULL, FALSE, CREATE_UNICODE_ENVIRONMENT, environment, NULL, &si, &pi);
+    r = CreateProcessW(NULL, path, NULL, NULL, FALSE, CREATE_UNICODE_ENVIRONMENT | DETACHED_PROCESS, environment, NULL, &si, &pi);
     HeapFree(GetProcessHeap(), 0, path);
     if (!r)
     {

